%% Type theory macros
\RequirePackage{xparse}
\RequirePackage{xcolor}

\definecolor{IdiotPurple}{RGB}{102, 51, 102}
\definecolor{RegalBlue}{RGB}{3,69,117}
\definecolor{CommandPurple}{RGB}{135, 23, 77}
\definecolor{Term}{HTML}{1527E6}
\definecolor{Prop}{HTML}{E51414}
\definecolor{STy}{HTML}{913D3D}
\definecolor{LTy}{HTML}{248886}
\NewDocumentCommand{\Tm}{m}{{\color{Term}{#1}}}
\NewDocumentCommand{\Meta}{m}{{\color{IdiotPurple}{#1}}}
\NewDocumentCommand{\Prop}{m}{{\color{Prop}#1}}
\NewDocumentCommand{\STy}{m}{{\color{STy}#1}}
\NewDocumentCommand{\LTy}{m}{{\color{LTy}#1}}

\NewDocumentCommand{\DeclVar}{mm}{#1\mathbin{:}#2}

\NewDocumentCommand{\IsSchema}{m}{#1\ \textsf{schema}}
\NewDocumentCommand{\EmpSchema}{}{\bullet}
\NewDocumentCommand{\ExtSchema}{O{\Gamma}mm}{#1, \DeclVar{#2}{#3}}

\NewDocumentCommand{\IsTm}{O{\Gamma}mm}{#1 \vdash \Tm{#2} : #3}
\NewDocumentCommand{\IsSTy}{O{\Gamma}m}{#1 \vdash \STy{#2}\ \textsf{finset}}
\NewDocumentCommand{\IsLTy}{O{\Gamma}m}{#1 \vdash \LTy{#2}\ \textsf{type}}
\NewDocumentCommand{\IsProp}{O{\Gamma}m}{#1 \vdash \Prop{#2}\ \textsf{prop}}

%%% UNIVERSES

\NewDocumentCommand{\PUni}{}{\mathbb{P}}
\NewDocumentCommand{\SUni}{}{\mathbb{U}}

%%% PROPOSITIONS

\NewDocumentCommand{\True}{}{\top}
\NewDocumentCommand{\False}{}{\bot}
\NewDocumentCommand{\Exists}{mO{}m}{%
  \exists \IfNoValueTF{#2}{#1}{\DeclVar{#1}{#2}}.\, #3%
}
\NewDocumentCommand{\Eq}{mO{}m}{\Tm{#1} =_{#2} \Tm{#3}}

%%% PI TYPE

\NewDocumentCommand{\PiType}{O{}mm}{%
  \IfNoValueTF{#1}{}{\DelimPrn{\DeclVar{#1}{#2}}}%
  \to%
  #3%
}
%% \Lam{x}{e}    produces λx. e
%% \Lam{x}[t]{e} produces λx : t. e
\NewDocumentCommand{\Lam}{mom}{
  \lambda 
    \IfNoValueTF{#2}{#1}{\DeclVar{#1}{#2}}
  .\, #3
}

%% \App{e}{e'}  produces e(e')
%% \App*{e}{e'} produces (e)(e')
\NewDocumentCommand{\App}{smm}{\IfBooleanTF{#1}{\DelimPrn{#2}}{#2}\DelimPrn{#3}}


%%% ONE-VARIABLE SUBSTITUTION

\NewDocumentCommand{\Subst}{smmm}{
  \DelimMin{2}%
  \IfBooleanTF{#1}{\DelimPrn{#2}}{#2}\Meta{\DelimBrk{\Tm{#3}/{#4}}}
}
